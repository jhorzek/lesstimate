
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../02-getting-started/">
      
      
        <link rel="next" href="../04-Model/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Optimizer design - lesstimate</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-optimizer-design" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="lesstimate" class="md-header__button md-logo" aria-label="lesstimate" data-md-component="logo">
      
  <img src="../lesstimate_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lesstimate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optimizer design
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jhorzek/lesstimate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="lesstimate" class="md-nav__button md-logo" aria-label="lesstimate" data-md-component="logo">
      
  <img src="../lesstimate_logo.png" alt="logo">

    </a>
    lesstimate
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jhorzek/lesstimate" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regularizing models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Optimizer design
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Optimizer design
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-fitting-function" class="md-nav__link">
    <span class="md-ellipsis">
      The Fitting Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ista-variants" class="md-nav__link">
    <span class="md-ellipsis">
      The ista variants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Code Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-lesstimate_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lesstimate types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-Penalty%20type/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    penalty types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-GLMNET/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GLMNET optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-ISTA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISTA optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-fitResults/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fitResults class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-BFGS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BFGS optimizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-fitting-function" class="md-nav__link">
    <span class="md-ellipsis">
      The Fitting Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ista-variants" class="md-nav__link">
    <span class="md-ellipsis">
      The ista variants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="the-optimizer-design">The Optimizer Design</h1>
<p>Note: We will not cover the optimizers themselves; here, we recommend
reading the following articles:</p>
<p><strong>GLMNET</strong>:</p>
<ul>
<li>Friedman, J., Hastie, T., &amp; Tibshirani, R. (2010). Regularization paths for generalized linear models via coordinate descent. Journal of Statistical Software, 33(1), 1–20. https://doi.org/10.18637/jss.v033.i01</li>
<li>Yuan, G.-X., Ho, C.-H., &amp; Lin, C.-J. (2012). An improved GLMNET for l1-regularized logistic regression. The Journal of Machine Learning Research, 13, 1999–2030. https://doi.org/10.1145/2020408.2020421</li>
</ul>
<p><strong>ISTA</strong>:</p>
<ul>
<li>Beck, A., &amp; Teboulle, M. (2009). A Fast Iterative Shrinkage-Thresholding Algorithm for Linear Inverse Problems. SIAM Journal on Imaging Sciences, 2(1), 183–202. https://doi.org/10.1137/080716542</li>
<li>Gong, P., Zhang, C., Lu, Z., Huang, J., &amp; Ye, J. (2013). A general iterative shrinkage and thresholding algorithm for non-convex regularized optimization problems. Proceedings of the 30th International Conference on Machine Learning, 28(2)(2), 37–45.</li>
<li>Parikh, N., &amp; Boyd, S. (2013). Proximal Algorithms. Foundations and Trends in Optimization, 1(3), 123–231.</li>
</ul>
<h2 id="the-fitting-function">The Fitting Function</h2>
<p>The objective of the optimizers is to minimize the fitting function. In both,
glmnet and ista we assume that this fitting function is given by a differentiable
part and a non-differentiable part. To be more specific, the fitting function
is given by:</p>
<p>$$f(\pmb{\theta}) = l(\pmb\theta) + s(\pmb\theta,\pmb{t}_s) + p(\pmb\theta,\pmb{t}_p)$$</p>
<p>where $l(\pmb\theta)$ is the unregularized fitting function 
(e.g., the -2log-likelihood) in the SEMs implemented in <strong>lessSEM</strong>. 
$s(\pmb\theta,\pmb{t}_s)$ is a differentiable (smooth) penalty function 
(e.g., a ridge penalty) and $p(\pmb\theta,\pmb{t}_p)$ is a non-differentiable
penalty function (e.g., a lasso penalty). All three functions take the parameter
estimates $\pmb\theta$ as input and return a single value as output. The penalty 
functions $s(\pmb\theta,\pmb{t}_s)$ and $p(\pmb\theta,\pmb{t}_p)$ additionally
expect vectors with tuning parameters--$\pmb{t}_s$ in case of the smooth penalty
and $\pmb{t}_p$ in case of the non-differentiable penalty. Thus, in theory both
penalty functions can use different tuning parameters. </p>
<p>A prototypical example for fitting functions of the form defined above is the 
elastic net. Here, </p>
<p>$$f(\pmb{\theta}) = l(\pmb\theta) + (1-\alpha)\lambda \sum_j\theta_j^2 + \alpha\lambda\sum_j| \theta_j|$$</p>
<p>The elastic net is a combination of a ridge penalty $\lambda \sum_j\theta_j^2$ and a lasso penalty $\lambda\sum_j| \theta_j|$. Note
that in this case, both penalties take in the same tuning parameters 
($\lambda$ and $\alpha$).</p>
<p>With this in mind, we can now have a closer look at the optimization functions.
We will start with glmnet (see function glmnet in the file inst/include/glmnet_class.hpp).
This function is called as follows:</p>
<div class="highlight"><pre><span></span><code>inline less::fitResults glmnet(model&amp; model_, 
                                  numericVector startingValuesRcpp,
                                  penaltyLASSOGlmnet&amp; penalty_,
                                  penaltyRidgeGlmnet&amp; smoothPenalty_, 
                                  const tuningParametersEnetGlmnet tuningParameters,
                                  const controlGLMNET&amp; control_ = controlGlmnetDefault())
{...}
</code></pre></div>
<p>The first argument is a model. This model has to be created by you and must 
inherit from the less::model class (see lessLM for an example). Most
importantly, this model must provide means to get the value of the first 
part of the fitting function: $l(\pmb\theta)$. It must also provide means
to compute the gradients of your fitting function.</p>
<p>The next argument are the starting values which are given as an numericVector. If you are using R, this is an Rcpp::NumericVector, in C++ a less::numericVector. This type is chosen because it can have labels 
and in its current implementation <strong>lesstimate</strong> expects that you give 
all your startingValues names.</p>
<p>Now come the actual penalty functions. The first one is the non-differentiable
penalty: the lasso $p(\pmb\theta)$. This must be an object of class penaltyLASSOGlmnet
which can be created with <code>less::penaltyLASSOGlmnet()</code>'. Next comes the differentiable
ridge penalty which must be of class <code>penaltyRidgeGlmnet</code> and can be created with 
<code>less::penaltyRidgeGlmnet</code>. </p>
<p>Now, the tuning parameters deviate a bit from what we discussed before. We said
that the differentiable and the non-differentiable penalty functions will each
take their own vector of tuning parameters ($\pmb t_s$ and $\pmb t_p$ respectively).
Note, however, that the elastic net uses the same tuning parameters for both,
ridge and lasso penalty. In the glmnet optimizer we therefore decided to combine
both of these into one: the <code>tuningParametersEnetGlmnet</code> struct. <code>tuningParametersEnetGlmnet</code> 
has three slots: alpha (to set $\alpha$), lambda (to set $\lambda$) and
a slot called weights. Now, the weights allow us to switch off the penalty for
selected parameters. For instance, in a linear regression we would not want to 
penalize the intercept. To this end, the fitting function that is actually
implemented internally is given by</p>
<p>$$f(\pmb{\theta}) = l(\pmb\theta) + (1-\alpha)\lambda \sum_j\omega_j \theta_j^2 + \alpha\lambda\sum_j\omega_j| \theta_j|$$</p>
<p>If we set $\omega_j = 0$ for a specific parameter, this parameter is unregularized.
Setting $\omega_j = 1$ means that parameter $j$ is penalized. $\omega_j$ can
also take any other value (e.g., $\omega_j = .4123$) which allows for penalties
such as the adaptive lasso. Importantly, the weights vector must be of the 
same length as <code>startingValuesRcpp</code>. That is, each parameter must have a weight
associated with it in the weights vector.</p>
<p>Finally, there is the <code>controlGLMNET</code> argument. This argument lets us fine tune the 
optimizer. To use the control argument, create a new control object in C++ as
follows:</p>
<div class="highlight"><pre><span></span><code>less::controlGLMNET myControlObject = less::controlGlmnetDefault();
</code></pre></div>
<p>Now, you can tweak each element of myControlObject; e.g.,</p>
<div class="highlight"><pre><span></span><code>myControlObject.maxIterOut = 100 // only 100 outer iterations
</code></pre></div>
<p>If you take a closer look at how the two penalty functions are handled within glmnet,
you will realize that we basically absorb the differentiable penalty in the 
normal fitting function. That is, only the non-differentiable part gets a special
treatment, while the differentiable part is simply added to the differntiable
$l(\pmb\theta)$. To give an example:</p>
<div class="highlight"><pre><span></span><code>gradients_kMinus1 = model_.gradients(parameters_kMinus1, parameterLabels) +
      smoothPenalty_.getGradients(parameters_kMinus1, parameterLabels, tuningParameters); // ridge part
</code></pre></div>
<p>Note how the gradients of $l(\pmb\theta)$ and $s(\pmb\theta,\pmb{t}_s)$ are combined into one.</p>
<h2 id="the-ista-variants">The ista variants</h2>
<p>Besides the glmnet optimizer, we also implemented variants of ista. These are
based on the publications mentioned above. The fitting function is again given
by </p>
<p>$$f(\pmb{\theta}) = l(\pmb\theta) + s(\pmb\theta,\pmb{t}_s) + p(\pmb\theta,\pmb{t}_p)$$</p>
<p>In the 
following, we will build a lot on what we've already discussed regarding the 
glmnet optimizer above. </p>
<p>First, let's have a look at the ista function;</p>
<div class="highlight"><pre><span></span><code>template&lt;typename T, typename U&gt; // T is the type of the tuning parameters
inline less::fitResults ista(
    model&amp; model_, 
    numericVector startingValuesRcpp,
    proximalOperator&lt;T&gt;&amp; proximalOperator_, // proximalOperator takes the tuning parameters
    // as input -&gt; &lt;T&gt;
    penalty&lt;T&gt;&amp; penalty_, // penalty takes the tuning parameters
    smoothPenalty&lt;U&gt;&amp; smoothPenalty_, // smoothPenalty takes the smooth tuning parameters
    // as input -&gt; &lt;U&gt;
    const T&amp; tuningParameters, // tuning parameters are of type T
    const U&amp; smoothTuningParameters, // tuning parameters are of type U
    const control&amp; control_ = controlDefault()
)
{...}
</code></pre></div>
<p>This function is more complicated that the glmnet function discussed above. 
But, let's start with the part that stays the same: First, we still have
to pass our model to the function. This model must have a fit and a gradients function
which return the fit and the gradient respectively. Next, the function again expects
us to provide starting values as an numericVector. We will skip the 
<code>proximalOperator</code> and the <code>penalty</code> for the moment (these relate to $p(\pmb\theta,\pmb t_p)$)
and concentrate on the <code>smoothPenalty</code> first. This is the function $s(\pmb\theta,\pmb t_s)$. In our previous example, we looked at the elastic net
penalty, where the smooth penalty is a ridge penalty function. Now, in the ista
optimizer, we can also pass in the ridge penalty as a smooth penalty. In fact, 
this is exactly what we do when we use ista to fit the elastic net. 
This smooth penalty has the tuning
parameters $\pmb t_s$ which are called <code>smoothTuningParameters</code> in the function call.
In case of the elastic net, these would again be $\alpha$ and $\lambda$ (and the
weights vector). Similar to the glmnet procedure outlined above, the differentiable
penalty $s(\pmb\theta,\pmb t_s)$ is simply absorbed in the unregularized fitting
function $l(\pmb\theta)$. </p>
<p>Now, for the non-differentiable part $p(\pmb\theta,\pmb p_s)$, the ista optimizer uses so-called proximal
operators. The details are beyond the scope here, but Parikh et al. (2013) provide
a very good overview of these algorithms. To make things work with ista, we
must pass such a proximal operator to the optimizer. Within <strong>lesstimate</strong>, we
have prepared a few of these proximal operators for well-known penalty functions.
Additionally, we need a function which returns the actual
penalty value. This is the penalty object in the function call. Finally, the 
penalty $p(\pmb\theta,\pmb t_p)$ gets its tuning parameters $\pmb t_p$. This
is the <code>tuningParameters</code> object above. To make things more concrete, let's look
at the elastic net again. In this case, penalty would be of class <code>less::penaltyLASSO</code> and the proximal operator of type <code>less::proximalOperatorLasso</code>.
The tuning parameters would again be $\alpha$ and $\lambda$ (and the
weights vector).</p>
<p>Note that many of the penalty function implemented in <strong>lesstimate</strong> are
typically not combined with a smooth penalty (e.g., scad, mcp, ...). In this
case, you must still pass a smoothPenalty object to ista. To this end,
we created the <code>less::noSmoothPenalty</code> class which can be used instead of
a smooth penalty like ridge. </p>
<p>Finally, there is the control argument. This argument lets us fine tune the 
optimizer. To use the control argument, create a new control object as
follows:</p>
<div class="highlight"><pre><span></span><code>less::control myControlObject = less::controlDefault();
</code></pre></div>
<p>Now, you can tweak each element of myControlObject; e.g.,</p>
<div class="highlight"><pre><span></span><code>myControlObject.L0 = .9
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>